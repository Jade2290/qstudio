# BabelDB 

## Query everything in one place.

Combine queries between any JDBC compatible database or JSON/CSV/HTML data sources
For videos and more help information see [BabelDB docs](https://www.timestored.com/pulse/help/babeldb).

# Query_web( REST/CSV/HTML )
To query JSON/CSV/HTML based tables use query_web and BabelDB will automatically detect the format and return a table:

```sql showcodeonly
select * from query_web('https://api3.binance.com/api/v3/ticker/price');
query_web('https://api.github.com/search/repositories?q=more+useful+keyboard')
query_web('https://www.iso20022.org/sites/default/files/ISO10383_MIC/ISO10383_MIC.csv')
query_web('https://en.wikipedia.org/wiki/List_of_bank_failures_in_the_United_States_(2008%E2%80%93present)')
https://fred.stlouisfed.org/graph/fredgraph.csv?id=MORTGAGE30US
```

```sql type='treemap' server='QDUCKDB' 
select Bank,"Assets ($mil.)" as Millions from query_web('https://en.wikipedia.org/wiki/List_of_bank_failures_in_the_United_States_(2008%E2%80%93present)')
```

# Query_data( hardcoded JSON/CSV )

```sql showcodeonly
query_data('Date,val
2001-01-07,88
2001-01-08,99
2001-01-09,55
2001-01-10,66
2001-01-11,70
2001-01-12,75
')
```


## Search Trends 2024


```sql server='QDUCKDB' type='timeseries' overrideJson={{grid:{top:50}}}
query_data('Week	Matthew Perry	chandrayaan-3	titanic submarine	hurricane lee	maine shooting	nashville shooting	Tina Turner	Ken Block	Lil Tay	Jerry Springer	Angus Cloud	Nicola Bulley	Jason Aldean	Joe Jonas	Smash Mouth	Matthew Perry_SD_MARKPOINT	chandrayaan-3_SD_MARKPOINT	titanic submarine_SD_MARKPOINT	hurricane lee_SD_MARKPOINT	maine shooting_SD_MARKPOINT	nashville shooting_SD_MARKPOINT	Tina Turner_SD_MARKPOINT	Ken Block_SD_MARKPOINT	Lil Tay_SD_MARKPOINT	Jerry Springer_SD_MARKPOINT	Angus Cloud_SD_MARKPOINT
01/01/2023	0	0	0	0	0	0	1	32	0	0	0	0	0	0	0								Ken Block			
01/08/2023	0	0	0	0	0	0	1	2	0	0	0	0	0	0	0											
01/15/2023	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0											
01/22/2023	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0											
01/29/2023	0	0	0	0	0	0	1	0	0	0	0	4	0	0	0											
02/05/2023	0	0	0	0	0	0	1	0	0	0	0	14	0	0	0											
02/12/2023	0	0	0	0	0	0	1	0	0	0	0	12	1	0	0											
02/19/2023	0	0	0	0	0	0	1	0	0	0	0	17	0	0	0											
02/26/2023	0	0	0	0	0	0	0	0	0	0	0	2	0	0	0											
03/05/2023	0	0	0	0	0	0	1	0	0	0	0	1	0	0	0											
03/12/2023	0	0	0	0	0	0	1	0	0	0	0	1	0	0	0											
03/19/2023	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0											
03/26/2023	0	0	0	0	0	38	1	0	0	0	0	0	0	0	0						nashville shooting					
04/02/2023	0	0	0	0	0	2	0	0	0	0	0	0	0	0	0											
04/09/2023	0	0	0	0	0	1	1	0	0	0	0	1	0	0	0											
04/16/2023	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0											
04/23/2023	0	0	0	0	0	0	0	0	0	44	0	0	0	0	0										Jerry Springer	
04/30/2023	0	0	0	0	0	0	0	0	0	4	0	0	0	0	0											
05/07/2023	0	0	0	0	0	0	0	0	0	1	0	1	0	0	0											
05/14/2023	0	0	0	0	0	0	0	0	0	2	0	0	0	0	0											
05/21/2023	0	0	0	0	0	0	56	0	0	1	0	0	0	0	0							Tina Turner				
05/28/2023	0	0	0	0	0	0	7	0	0	1	0	0	0	0	0											
06/04/2023	0	0	0	0	0	0	2	0	0	0	0	0	0	0	0											
06/11/2023	0	0	0	0	0	0	1	0	0	1	0	0	0	0	0											
06/18/2023	0	0	73	0	0	0	1	0	0	0	0	0	0	0	0			titanic submarine								
06/25/2023	0	0	6	0	0	0	1	0	0	1	0	1	0	0	0											
07/02/2023	0	0	1	0	0	0	1	0	0	0	0	0	0	0	0											
07/09/2023	0	1	1	0	0	0	1	0	0	0	0	0	1	0	0											
07/16/2023	0	1	0	0	0	0	1	0	0	0	0	0	19	0	0											
07/23/2023	0	0	0	0	0	0	1	0	0	0	0	0	14	0	0											
07/30/2023	0	1	0	0	0	0	1	0	0	0	69	0	3	0	0											Angus Cloud
08/06/2023	0	2	0	0	0	0	1	0	40	0	3	0	2	0	0									Lil Tay		
08/13/2023	0	2	0	0	0	0	1	0	2	0	1	0	1	1	0											
08/20/2023	0	100	0	0	0	0	1	0	1	0	0	0	1	0	0		chandrayaan-3									
08/27/2023	0	6	0	0	0	0	0	0	0	0	0	0	1	0	0											
09/03/2023	0	3	0	17	0	0	0	0	0	0	0	0	1	14	12				17							
09/10/2023	0	2	0	24	0	0	0	0	0	0	0	0	1	3	1				hurricane lee							
09/17/2023	0	2	0	2	0	0	0	0	0	0	2	0	1	3	0											
09/24/2023	0	2	0	0	0	0	0	0	1	0	1	0	1	2	0											
10/01/2023	0	1	0	0	0	0	1	0	6	0	0	0	1	1	0											
10/08/2023	0	1	0	0	0	0	0	0	1	0	0	0	0	1	0											
10/15/2023	0	1	0	0	0	0	1	0	1	0	0	0	0	1	0											
10/22/2023	0	1	0	0	29	0	0	0	0	0	0	0	0	0	0					maine shooting						
10/29/2023	100	0	0	0	2	0	1	0	0	0	0	0	0	0	0	Matthew Perry										
11/05/2023	7	0	0	0	0	0	1	0	0	0	0	0	0	1	0											
11/12/2023	3	0	0	0	0	0	1	0	0	0	0	0	0	0	0											
11/19/2023	2	0	0	0	0	0	1	0	0	0	0	0	0	0	0											
11/26/2023	1	0	0	0	0	0	1	0	0	0	0	0	0	0	0											
12/03/2023	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0											
')
```

# Population Trends

## Niger Population

```sql type='stack_horizontal' server='QDUCKDB' 
/* https://www.census.gov/data-tools/demo/idb/ */
select 
 Age,
 CASE WHEN males<mini THEN males ELSE mini END as males ,
 CASE WHEN females<mini THEN -females ELSE -mini END as females,
 CASE WHEN females<mini THEN 0 ELSE -(females-mini) END as femalesSurplus ,
 CASE WHEN males<mini THEN 0 ELSE males-mini END as malesSurplus ,
 FROM 
(select *, CASE WHEN males<females THEN males ELSE females END as mini 
 from 
query_data('Age,Males,Females
0,564163,551463
1,530222,520363
2,505621,496367
3,484178,475397
4,464755,456333
5,446766,438722
6,429733,422102
7,413638,406406
8,398501,391612
9,384863,378245
10,371682,365850
11,358638,354209
12,346676,343717
13,335934,334501
14,325582,325713
15,315874,317563
16,304803,307986
17,291591,296204
18,278601,284336
19,265650,272587
20,253360,261236
21,239998,248740
22,224740,233844
23,212585,221522
24,201367,209607
25,190123,197951
26,179062,186578
27,168419,175703
28,157968,165268
29,147700,155098
30,138374,146020
31,129813,137811
32,123617,131363
33,118055,125299
34,112393,119456
35,108929,115863
36,103815,111319
37,98918,106846
38,94205,102529
39,90102,98503
40,86125,94657
41,82438,90875
42,79082,87188
43,76024,83684
44,73292,80566
45,70172,77836
46,65586,71872
47,62179,68503
48,59331,65615
49,56365,62487
50,53979,59627
51,51859,57436
52,50026,55136
53,47958,52857
54,46041,50576
55,44041,48326
56,43108,46714
57,42317,45168
58,41271,43412
59,39777,41603
60,38258,39450
61,36700,37545
62,35175,35685
63,33461,33957
64,31685,32109
65,29864,30198
66,27808,28426
67,25825,26549
68,23925,24728
69,22284,23308
70,20788,21910
71,19460,20622
72,18174,19463
73,16927,18413
74,15795,17316
75,14603,16132
76,13407,14909
77,12179,13625
78,11011,12488
79,9871,11199
80,8715,9978
81,7606,8755
82,6439,7576
83,5409,6367
84,4425,5356
85,3572,4360
86,2819,3543
87,2196,2823
88,1722,2308
89,1337,1825
90,1010,1440
91,737,1068
92,527,786
93,354,543
94,247,387
95,158,254
96,96,158
97,56,96
98,35,59
99,19,34
100+,21,37
'))
```

## Japan Population

```sql type='stack_horizontal' server='QDUCKDB' 
/* https://www.census.gov/data-tools/demo/idb/ */
select 
 Age,
 CASE WHEN males<mini THEN males ELSE mini END as males ,
 CASE WHEN females<mini THEN -females ELSE -mini END as females,
 CASE WHEN females<mini THEN 0 ELSE -(females-mini) END as femalesSurplus ,
 CASE WHEN males<mini THEN 0 ELSE males-mini END as malesSurplus ,
 FROM 
(select *, CASE WHEN males<females THEN males ELSE females END as mini 
 from 
query_data('Age,Males,Females
0,441097,417432
1,447576,422832
2,454476,428626
3,462238,435235
4,482670,453838
5,506636,475965
6,521998,490126
7,537697,504629
8,546717,512804
9,555277,520835
10,565591,531018
11,568949,534365
12,575519,540809
13,582017,548400
14,587016,553535
15,589328,555965
16,584947,552320
17,570149,537415
18,571169,526591
19,587994,539131
20,597786,549361
21,605874,558511
22,611635,566075
23,608361,567455
24,644841,567948
25,648859,571760
26,654094,576811
27,670157,580126
28,676082,590246
29,628788,592589
30,626171,589222
31,640787,601020
32,632461,609399
33,627212,624840
34,639057,648759
35,666273,672425
36,685406,692233
37,699471,710709
38,721719,750856
39,740107,768973
40,742531,772839
41,743879,773282
42,761867,786161
43,794456,800304
44,779789,819934
45,806300,848346
46,827889,869421
47,854209,905637
48,901124,935369
49,960778,975008
50,962378,983472
51,938376,963933
52,912944,937572
53,886301,907173
54,885968,886875
55,864908,871335
56,810539,822700
57,714712,719871
58,816558,826544
59,786167,778996
60,760956,757749
61,735328,734477
62,730029,726605
63,731700,735190
64,739772,741643
65,713858,720840
66,700181,712400
67,728345,746399
68,739566,763941
69,744209,775708
70,775305,823232
71,805476,866850
72,842764,919958
73,891843,990002
74,935349,1053061
75,898823,1027158
76,768946,886808
77,532015,621438
78,568088,689533
79,622941,778339
80,589178,752945
81,571753,748040
82,518760,699768
83,439585,614940
84,363904,544975
85,354494,556941
86,329172,542304
87,290117,510069
88,244172,458398
89,205011,412729
90,174242,375890
91,143130,330798
92,113116,282559
93,87253,236055
94,66982,196962
95,49928,159961
96,35843,126894
97,24768,97855
98,16073,71440
99,9772,50252
100+,14069,99480
'))
```

## Japan Birth Deaths

```sql type='timeseries' server='QDUCKDB' 
select *,Births-Deaths as Delta from query_data('Year,Births,Deaths,Births_SD_MARKLINE,Births_SD_MARKAREA,Births_SD_MARKPOINT
1899,1386981,932087
1900,1420534,910744
1901,1501591,925810
1902,1510835,959126
1903,1489816,931008
1904,1440371,955400
1905,1452770,1004661
1906,1394295,955256
1907,1614472,1016798
1908,1662815,1029447
1909,1693850,1091264
1910,1712857,1064234
1911,1747803,1043906
1912,1737674,1037016
1913,1757441,1027257
1914,1808402,1101815,,World War
1915,1799326,1093793,,World War
1916,1804822,1187832,,World War
1917,1812413,1199669,,World War
1918,1791992,1493162,,World War
1919,1778685,1281965
1920,2025564,1422096
1921,1990876,1288570
1922,1969314,1286941
1923,2043297,1332485
1924,1998520,1254946
1925,2086091,1210706
1926,2104405,1160734
1927,2060737,1214323
1928,2135852,1236711
1929,2077026,1261228
1930,2085101,1170867
1931,2102784,1240891
1932,2182742,1175344
1933,2121253,1193987
1934,2043783,1234684
1935,2190704,1161936
1936,2101969,1230278
1937,2180734,1207899
1938,1928321,1259805
1939,1901573,1268760,,World War
1940,2115867,1186595,,World War
1941,2277283,1149559,,World War
1942,2233660,1166630,,World War
1943,2253535,1213811,,World War
1947,2678792,1138238,,World War
1948,2681624,950610
1949,2696638,945444
1950,2337507,904876
1951,2137689,838998
1952,2005162,765068
1953,1868040,772547
1954,1769580,721491
1955,1730692,693523
1956,1665278,724460
1957,1566713,752445
1958,1653469,684189
1959,1626088,689959
1960,1606041,706599
1961,1589372,695644
1962,1618616,710265
1963,1659521,670770
1964,1716761,673067
1965,1823697,700438
1966,1360974,670342,,,Year of the Fire Horse
1967,1935647,675006
1968,1871839,686555
1969,1889815,693787
1970,1934239,712962
1971,2000973,684521
1972,2038682,683751
1973,2091983,709416
1974,2029989,710510
1975,1901440,702275
1976,1832617,703270
1977,1755100,690074
1978,1708643,695821
1979,1642580,689664
1980,1576889,722801
1981,1529455,720262
1982,1515392,711883
1983,1508687,740038
1984,1489780,740247
1985,1431577,752283
1986,1382946,750620
1987,1346658,751172
1988,1314006,793014
1989,1246802,788594
1990,1221585,820305
1991,1223245,829797
1992,1208989,856643
1993,1188282,878532
1994,1238328,875933
1995,1187064,922139
1996,1206555,896211
1997,1191665,913402
1998,1203147,936484
1999,1177669,982031
2000,1190547,961653
2001,1170662,970331
2002,1153855,982379
2003,1123610,1014951
2004,1110721,1028602
2005,1062530,1083796,Population Decline
2006,1092674,1084451
2007,1089818,1108334
2008,1091156,1142407
2009,1070036,1141865
2010,1071305,1197014
2011,1050807,1253068
2012,1037232,1256359
2013,1029817,1268438
2014,1003609,1273025
2015,1005721,1290510
2016,977242,1308158
2017,946146,1340567
2018,918400,1362470
2019,865239,1381093
')
```
# Cost of Christmas by Country

```sql type='stack_horizontal' server='QDUCKDB' 
select Country,CostOfChristmas,-CostOfChristmas,Trunk,-Trunk,Star,-Star from 
 query_data('Country,CostOfChristmas,AvgSalary,Trunk,Star
-,0,0,300
-,0,0,300
Columbia,198,13560
South Africa,166,19950
India,146,24887
Canada,1717,49446
Germany,1653,58853
USA,1205,77463
Australia,1188,59973
France,1142,52686
Mexico,1055,22106
UK,1042,53901
Italy,841,44827
Spain,742,42796
Netherlands,657,62133
Philippines,614,9430
Fiji,278,25118
Zimbabwe,254,7212
Nigeria,218,5288
Kenya,215,11651
Dominican Republic,208,4206
Nepal,86,7290
Uganda,64,9029
Star,0,0,0,50
')
```

# Query_db(db,) - join data from different databases

Add a mysql / postgresql connection and query them. Notice the SQL queries can be wrapped in parentheses (), Quotes also work but parentheses allow SQL highlighting to work better in most editors.

Comparing the U.S. Unemployment rate to U.S. National Home Price Index:


```sql showcodeonly
select a.date, CSUSHPINSA/63.74 AS CSUSHPINSA,b.UNRATE/6.60 AS UNRATE
  FROM query_db('mysql','SELECT * FROM TRADES WHERE SYM="CSUSHPINSA"') a
  LEFT JOIN query_db('FRED','SELECT * FROM UNRATE') b ON a.date=b.date
```